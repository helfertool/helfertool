{% extends "helfertool/admin.html" %}
{% load i18n django_bootstrap5 icons %}

{% block content %}
    <h1>{% trans "Check installation" %}</h1>

    <h2>{% trans "Helfertool" %}</h2>
    <div class="row">
        <div class="col-xs-12 col-xl-6">
            <table class="table" aria-label="{% trans 'Status of Helfertool' %}">
                <tr class="d-flex">
                    <th class="col-6" scope="row">{% trans "Version" %} </th>
                    <td class="col-6 text-break">
                        {{ version }}
                        {% if container_version %}
                            ({% trans "Container:" %} {{ container_version }})
                        {% endif %}
                    </td>
                </tr>
                <tr class="d-flex">
                    <th class="col-6" scope="row">{% trans "Debug mode" %} </th>
                    <td class="col-6 text-break">
                        {% if debug %}
                            <span class="text-danger">
                                {% icon "circle-exclamation" %} {% trans "Debug mode enabled" %}
                            </span>
                        {% else %}
                            {% icon "circle-check" %} {% trans "Debug mode disabled" %}
                        {% endif %}
                    </td>
                </tr>
                <tr class="d-flex">
                    <th class="col-6" scope="row">{% trans "Secret key" %} </th>
                    <td class="col-6 text-break">
                        {% if secret_ok %}
                            {% icon "circle-check" %}
                        {% else %}
                            <span class="text-danger">
                                {% icon "circle-exclamation" %} {% trans "Weak secret key" %}
                            </span>
                        {% endif %}
                    </td>
                </tr>
                <tr class="d-flex">
                    <th class="col-6" scope="row">{% trans "Templates" %} </th>
                    <td class="col-6 text-break">
                        {% if templates_ok %}
                            {% icon "circle-check" %}
                        {% else %}
                            <span class="text-danger">
                                {% icon "circle-exclamation" %} {% trans "Templates missing" %}
                            </span>
                        {% endif %}
                    </td>
                </tr>
            </table>
        </div>
    </div>

    <h2>{% trans "External services" %}</h2>
    <div class="row">
        <div class="col-xs-12 col-xl-6">
            <table class="table" aria-label="{% trans 'Status of external services' %}">
                <tr class="d-flex">
                    <th class="col-6" scope="row">{% trans "Mail (SMTP)" %} </th>
                    <td class="col-6 text-break">
                        {% if mail_smtp_ok %}
                            {% icon "circle-check" %}
                        {% else %}
                            <span class="text-danger">
                                {% icon "circle-exclamation" %} {% trans "Cannot connect to mail server" %}
                            </span>
                        {% endif %}
                    </td>
                </tr>

                <tr class="d-flex">
                    <th class="col-6" scope="row">{% trans "Mail (IMAP)" %} </th>
                    <td class="col-6 text-break">
                        {% if mail_imap_configured %}
                            {% if mail_imap_ok %}
                                {% icon "circle-check" %}
                            {% else %}
                                <span class="text-danger">
                                    {% icon "circle-exclamation" %} {% trans "Cannot connect to mail server" %}
                                </span>
                            {% endif %}
                        {% else %}
                            {% icon "minus" %}
                        {% endif %}
                    </td>
                </tr>

                <tr class="d-flex">
                    <th class="col-6" scope="row">{% trans "RabbitMQ" %} </th>
                    <td class="col-6 text-break">
                        {% if celery_broker_ok %}
                            {% icon "circle-check" %}
                        {% else %}
                            <span class="text-danger">
                                {% icon "circle-exclamation" %} {% trans "Cannot connect to RabbitMQ server" %}
                            </span>
                        {% endif %}
                    </td>
                </tr>

                <tr class="d-flex">
                    <th class="col-6" scope="row">{% trans "LDAP" %} </th>
                    <td class="col-6 text-break">
                        {% if ldap_configured %}
                            {% if ldap_ok %}
                                {% icon "circle-check" %}
                            {% else %}
                                <span class="text-danger">
                                    {% icon "circle-exclamation" %} {% trans "Cannot connect to LDAP server" %}
                                </span>
                            {% endif %}
                        {% else %}
                            {% icon "minus" %}
                        {% endif %}
                    </td>
                </tr>

                <tr class="d-flex">
                    <th class="col-6" scope="row">{% trans "Search for similar names" %} </th>
                    <td class="col-6 text-break">
                        {% if similarity_search %}
                            {% icon "circle-check" %}
                        {% else %}
                            {% icon "minus" %}
                        {% endif %}
                    </td>
                </tr>
            </table>
        </div>
    </div>

    <h2>{% trans "Header" %}</h2>
    <div class="row">
        <div class="col-xs-12 col-xl-6">
            <table class="table" aria-label="{% trans 'Status of HTTP headers' %}">
                <tr class="d-flex">
                    <th class="col-6" scope="row">Host</th>
                    <td class="col-6 text-break">
                        {% if header_host %}
                            {{ header_host }}
                        {% else %}
                            <span class="text-danger">
                                {% icon "circle-exclamation" %}
                            </span>
                        {% endif %}
                    </td>
                </tr>

                <tr class="d-flex">
                    <th class="col-6" scope="row">X-Forwarded-For</th>
                    <td class="col-6 text-break">
                        {% if header_x_forwarded_for %}
                            {{ header_x_forwarded_for }}
                        {% else %}
                            <span class="text-danger">
                                {% icon "circle-exclamation" %}
                            </span>
                        {% endif %}
                    </td>
                </tr>

                <tr class="d-flex">
                    <th class="col-6" scope="row">X-Forwarded-Proto</th>
                    <td class="col-6 text-break">
                        {% if header_x_forwarded_proto %}
                            {{ header_x_forwarded_proto }}
                        {% else %}
                            <span class="text-danger">
                                {% icon "circle-exclamation" %}
                            </span>
                        {% endif %}
                    </td>
                </tr>
            </table>
        </div>
    </div>
{% endblock %}
